# Epic 9 Retrospective: Stabilization & Polish

**Дата:** 2026-02-22
**Фасилитатор:** Bob (Scrum Master)
**Участники:** Alice (PO), Charlie (Senior Dev), Dana (QA), Elena (Junior Dev), Yury (Project Lead)

---

## Сводка Epic

| Метрика | Значение |
|---------|----------|
| **Историй завершено** | 6/6 (100%) |
| **Плановых историй** | 5 (из Epic 8 retro) |
| **Emergent историй** | 1 (9.6 — architecture docs) |
| **Code Review issues** | ~35 найдено, все исправлены |
| **HIGH issues** | 5 (все исправлены) |
| **MEDIUM issues** | ~18 |
| **Unit тестов добавлено** | ~50+ |
| **Production incidents** | 0 |
| **Статус** | Done |

### Доставленные истории

| История | Название | Статус | Тип | CR Issues |
|---------|----------|--------|-----|-----------|
| 9.1 | Auth Session Expires Investigation | Done | Full-stack | 7 (1H, 3M, 3L) |
| 9.2 | Load Generator Fixes | Done | Frontend | 8 (5M, 3L) |
| 9.3 | Role-Based Sidebar Visibility | Done | Frontend | 4 (1H, 3M) |
| 9.4 | Self-Service Password Change | Done | Full-stack | 6 (1H, 4M, 1L) |
| 9.5 | Demo Credentials Login Page | Done | Full-stack | 4 (2H, 2M) |
| 9.6 | Architecture Documentation Update | Done | Documentation | 6 (2M, 4L) |

---

## Что пошло хорошо

### Доставка продукта

- **100% completion** — пятый эпик подряд с полным завершением
- **0 emergent bugs** — все баги были запланированы из Epic 8 retro
- **Все issues из Epic 8 закрыты:**
  - BUG-01 (Auth session) → Story 9.1 ✅
  - BUG-02 (Load Generator) → Story 9.2 ✅
  - FR-NEW-01 (Role-based sidebar) → Story 9.3 ✅
  - FR-NEW-02 (Password change) → Story 9.4 ✅
  - DOC-01 (Architecture docs) → Story 9.6 ✅
- **Бонусная Story 9.5** — Demo credentials для onboarding

### Техническое качество

- **Story 9.1 Root Cause Analysis** — найдены 3 отдельные проблемы:
  1. Нет `/api/v1/auth/me` endpoint для восстановления сессии
  2. Нет обработки 401 в axios interceptor
  3. Flash of login form при загрузке
- **ROLE_MENU_ACCESS маппинг** (Story 9.3) — добавление нового пункта меню = одна строчка
- **Story 9.2** — исправлена архитектурная проблема с nginx URL routing

### Code Review эффективность

- **35 issues найдено до merge**
- **5 HIGH severity issues пойманы:**
  - 9.1: AC4 не реализован (network error handling)
  - 9.3: AC4 — отсутствовал тест для /users route protection
  - 9.4: AC5 — кнопка Submit не была disabled при невалидной форме
  - 9.5: Developer features не включали Test (несоответствие со Story 9.3)
  - 9.5: Противоречие AC между stories 9.3 и 9.5

### Action Items выполнение

- **7/7 action items из Epic 8 закрыты** (100%)
- Второй эпик подряд с полным закрытием action items
- PA-05 и PA-06 добавлены в CLAUDE.md

---

## Проблемы и обучение

### 1. AC validation gaps

**Проблема:** В нескольких stories code review находил несоответствие реализации и AC.

**Примеры:**
- 9.1 AC4 — не было сообщения об ошибке сети
- 9.4 AC5 — кнопка Submit не была disabled
- 9.5 AC3 — таблица не была адаптивной

**Root cause:** Быстрая разработка, недостаточная проверка AC перед отправкой на review.

**Решение:** Рассмотреть AC verification checklist.

### 2. Противоречия между stories

**Проблема:** Story 9.5 содержала список features для Developer, который не совпадал со Story 9.3.

**Root cause:** Stories создавались в разное время, не сверялись друг с другом.

**Решение:** При создании связанных stories сверять AC.

### 3. Nginx URL routing

**Проблема:** Load Generator использовал `http://localhost:8080`, что не работает через nginx.

**Root cause:** Непонимание архитектуры nginx reverse proxy.

**Решение:** Документировано в architecture.md (Story 9.6).

---

## Выполнение Action Items из Epic 8

| # | Action Item | Статус | Комментарий |
|---|-------------|--------|-------------|
| BUG-01 | Auth session expires | ✅ Done | Story 9.1 — /me endpoint, 401 handling |
| BUG-02 | Load Generator не работает | ✅ Done | Story 9.2 — URL fix, error handling |
| FR-NEW-01 | Role-based sidebar visibility | ✅ Done | Story 9.3 — ROLE_MENU_ACCESS |
| FR-NEW-02 | Self-service password change | ✅ Done | Story 9.4 — full implementation |
| DOC-01 | Обновить architecture.md | ✅ Done | Story 9.6 — nginx, production topology |
| PA-05 | DTO field checklist | ✅ Added | В CLAUDE.md |
| PA-06 | useEffect cleanup | ✅ Added | В CLAUDE.md |

**Итого:** 7/7 выполнено (100%)

---

## Метрики качества тренд

| Метрика | Epic 5 | Epic 6 | Epic 7 | Epic 8 | Epic 9 | Тренд |
|---------|--------|--------|--------|--------|--------|-------|
| Плановых историй | 5 | 7 | 8 | 10 | 6 | — |
| Emergent/Hotfix | 5 | 1 | 3 | 0 | 0 | ✅ Стабильно |
| Completion rate | 100% | 100% | 100% | 100% | 100% | ✅ 5/5 |
| Action items done | 2/6 | 1/8 | 10/10 | 7/7 | — | ✅ Улучшение |
| Production incidents | 0 | 0 | 0 | 0 | 0 | ✅ Стабильно |

---

## Обратная связь от Yury (Project Lead)

### Обнаруженные баги

| # | Описание | Severity | Воспроизведение |
|---|----------|----------|-----------------|
| BUG-03 | Approvals не обновляются в реальном времени — требуется обновление страницы | MEDIUM | Создать pending route, проверить вкладку Approvals |
| BUG-04 | Rate limit не работает — лимит 5, проходит 20 запросов/сек | **CRITICAL** | `/set-local-rate-limit` + Load Generator |

### Feature Requests

| # | Описание | Priority | Effort |
|---|----------|----------|--------|
| FR-01 | Security может откатить опубликованный роут в draft | MEDIUM | Medium |
| FR-04 | Автор может удалить свой роут в статусе draft | MEDIUM | Small |
| FR-02 | Health check для Nginx на вкладке метрик | LOW | Small |
| FR-03 | Ссылка на Swagger на странице входа | LOW | Small |

---

## Action Items Epic 9

### Process Improvements

| # | Action Item | Owner | Статус |
|---|-------------|-------|--------|
| E9-01 | AC verification checklist перед code review | SM | Pending |
| E9-02 | Сверять AC между связанными stories | PO | Pending |
| E9-03 | Обновить epic-9 статус на `done` | SM | ✅ Done |

### Epic 10 Planning

| # | Item | Priority | Notes |
|---|------|----------|-------|
| BUG-04 | Rate limit не работает | **CRITICAL** | Первый приоритет |
| BUG-03 | Approvals real-time updates | MEDIUM | WebSocket или polling |
| FR-01 | Security откат роута | MEDIUM | RBAC расширение |
| FR-04 | Автор удаляет draft | MEDIUM | Ownership-based delete |
| FR-02 | Nginx health check | LOW | HealthCheckService |
| FR-03 | Swagger ссылка на login | LOW | DX improvement |

---

## Ключевые выводы

1. **Все баги и FR из Epic 8 закрыты** — 7/7 action items (100%)
2. **Code Review эффективен** — 5 HIGH issues пойманы до merge
3. **Новые баги обнаружены** — BUG-03, BUG-04 (critical rate limit)
4. **4 feature requests** — RBAC improvements, UX enhancements
5. **Epic 10 необходим** — критический баг rate limit требует исправления

---

## Next Steps

1. **Создать Epic 10: Maintenance & Bug Fixes**
   - BUG-04: Rate limit investigation (CRITICAL)
   - BUG-03: Approvals real-time updates
   - FR-01: Security role route rollback
   - FR-04: Author draft deletion
   - FR-02, FR-03: UX improvements

2. **Обновить sprint-status.yaml**
   - Epic 9 → done
   - Epic 10 → in-progress

3. **Обновить epics.md**
   - Добавить Epic 10 с новыми stories

---

*Сгенерировано в ходе Team Retrospective*
*Следующий шаг: Epic 10 Planning*
