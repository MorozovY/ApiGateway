# –†–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–∞ Epic 2: User Authentication & Access Control

**–î–∞—Ç–∞:** 2026-02-17
**–§–æ—Ä–º–∞—Ç:** Starfish Retrospective
**–£—á–∞—Å—Ç–Ω–∏–∫–∏:** Yury (Product Owner), Bob (Scrum Master), Alice (Product Owner), Charlie (Senior Dev), Dana (QA Engineer)

---

## –û–±–∑–æ—Ä Epic 2

| –ú–µ—Ç—Ä–∏–∫–∞ | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------|----------|
| **–í—Å–µ–≥–æ –∏—Å—Ç–æ—Ä–∏–π** | 6 |
| **–ó–∞–≤–µ—Ä—à–µ–Ω–æ** | 6 (100%) |
| **Backend —Ç–µ—Å—Ç—ã** | 180+ |
| **Frontend —Ç–µ—Å—Ç—ã** | 44 |
| **Code Reviews** | 6 (–≤—Å–µ —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞) |
| **–ú–æ–¥–µ–ª—å –∞–≥–µ–Ω—Ç–∞** | Claude Opus 4.5 (–≤—Å–µ –∏—Å—Ç–æ—Ä–∏–∏) |

### –ó–∞–≤–µ—Ä—à—ë–Ω–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏

| Story | –ù–∞–∑–≤–∞–Ω–∏–µ | Backend —Ç–µ—Å—Ç—ã | Frontend —Ç–µ—Å—Ç—ã | HIGH issues | MEDIUM issues |
|-------|----------|---------------|----------------|-------------|---------------|
| 2.1 | User Entity & Database Schema | ~30 | - | 0 | 2 |
| 2.2 | JWT Authentication Service | 38 | - | 2 | 4 |
| 2.3 | Authentication Middleware | 20 | - | 1 | 5 |
| 2.4 | Role-Based Access Control | 40+ | - | 0 | 3 |
| 2.5 | Admin UI Login Page | - | 20 | 1 | 3 |
| 2.6 | User Management Admin | 30 | 24 | 1 | 2 |

---

## –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ Action Items –∏–∑ Epic 1

| # | Action Item | –°—Ä–æ–∫ | –°—Ç–∞—Ç—É—Å |
|---|-------------|------|--------|
| 1 | –°–æ–∑–¥–∞—Ç—å CLAUDE.md —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞ | Epic 1 | ‚úÖ Done (Epic 1) |
| 2 | –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞ —Ä—É—Å—Å–∫–∏–π | Story 2.2 | ‚úÖ Done (~50 –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤) |
| 3 | –î–æ–±–∞–≤–∏—Ç—å checklist reactive patterns –≤ code-review workflow | Before Epic 2 | ‚è∏Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ (–ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è, –Ω–æ –Ω–µ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω) |
| 4 | –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ –Ω–∞–∑–≤–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –Ω–∞ —Ä—É—Å—Å–∫–∏–π | Story 2.2 | ‚úÖ Done (~100 —Ç–µ—Å—Ç–æ–≤) |
| 5 | –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–æ —Ä–∞–∑–±–∏–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∏—Å—Ç–æ—Ä–∏–π | Sprint Planning | üî≤ Pending |

**–í—ã–≤–æ–¥—ã:** 3 –∏–∑ 5 action items –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤—ã–ø–æ–ª–Ω–µ–Ω—ã. –ü—Ä–∞–≤–∏–ª–∞ CLAUDE.md —Å–æ–±–ª—é–¥–∞–ª–∏—Å—å –≤–æ –≤—Å–µ—Ö –∏—Å—Ç–æ—Ä–∏—è—Ö Epic 2.

---

## Starfish Analysis

### ‚≠ê KEEP DOING (–ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å)

| # | –ü—Ä–∞–∫—Ç–∏–∫–∞ | –û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ |
|---|----------|-------------|
| 1 | **RFC 7807 Error Handling** | –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤–æ –≤—Å–µ—Ö endpoint, –≤–∫–ª—é—á–∞—è WebFilter exceptions |
| 2 | **Previous Story Intelligence** | –ö–∞–∂–¥–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ –∑–Ω–∞–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| 3 | **Code Review ‚Üí Fix ‚Üí Re-test —Ü–∏–∫–ª** | –í—Å–µ 6 –∏—Å—Ç–æ—Ä–∏–π –ø—Ä–æ—à–ª–∏ review —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞ (–ø–æ—Å–ª–µ —Ñ–∏–∫—Å–æ–≤) |
| 4 | **–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ —Ç–µ—Å—Ç—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º** | –ü—Ä–∞–≤–∏–ª–∞ CLAUDE.md —Å–æ–±–ª—é–¥–∞–ª–∏—Å—å –≤–æ –≤—Å–µ—Ö –∏—Å—Ç–æ—Ä–∏—è—Ö |
| 5 | **Reactive patterns –±–µ–∑ @PostConstruct** | –ù–æ–ª—å –Ω–∞—Ä—É—à–µ–Ω–∏–π reactive patterns –≤ Epic 2 (–±—ã–ª–æ 3 –≤ Epic 1) |
| 6 | **AuditService –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π** | –°–æ–∑–¥–∞–Ω –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Ä–æ–ª–µ–π (Story 2.6) |

### ‚¨áÔ∏è LESS OF (–ú–µ–Ω—å—à–µ)

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –ß–∞—Å—Ç–æ—Ç–∞ | –í–ª–∏—è–Ω–∏–µ |
|---|----------|---------|---------|
| 1 | **Thread.sleep() –≤ —Ç–µ—Å—Ç–∞—Ö** | Story 2.2 (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ) | LOW ‚Äî –¥–æ–ø—É—Å—Ç–∏–º–æ –¥–ª—è expiration —Ç–µ—Å—Ç–æ–≤ |
| 2 | **Duplicated constants** | Story 2.3 (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ) | MEDIUM ‚Äî —Å–æ–∑–¥–∞–Ω Constants.kt |
| 3 | **@Disabled —Ç–µ—Å—Ç—ã** | Story 2.6 | MEDIUM ‚Äî —Ç—Ä–µ–±—É–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è |

### ‚¨ÜÔ∏è MORE OF (–ë–æ–ª—å—à–µ)

| # | –ü—Ä–∞–∫—Ç–∏–∫–∞ | –û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç |
|---|----------|------------------|
| 1 | **GlobalExceptionHandler –¥–ª—è –≤—Å–µ—Ö —Å–ª–æ—ë–≤** | –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏–∑ WebFilter, Controller, Service |
| 2 | **React Query –¥–ª—è data fetching** | –£—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω—ë–Ω –≤ Story 2.5-2.6, –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –≤–æ –≤—Å–µ—Ö UI stories |
| 3 | **–ê—É–¥–∏—Ç-–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π** | –†–∞—Å—à–∏—Ä–∏—Ç—å –Ω–∞ –¥—Ä—É–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ–º–∏–º–æ —Å–º–µ–Ω—ã —Ä–æ–ª–µ–π |

### üõë STOP DOING (–ü—Ä–µ–∫—Ä–∞—Ç–∏—Ç—å)

| # | –ê–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω | –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ |
|---|--------------|--------------|
| 1 | **–û—Å—Ç–∞–≤–ª—è—Ç—å @Disabled —Ç–µ—Å—Ç—ã –±–µ–∑ issue** | –°–æ–∑–¥–∞–≤–∞—Ç—å GitHub issue –¥–ª—è –∫–∞–∂–¥–æ–≥–æ @Disabled —Ç–µ—Å—Ç–∞ |
| 2 | **RestControllerAdvice –¥–ª—è WebFilter exceptions** | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ErrorWebExceptionHandler (GlobalExceptionHandler) |

### üöÄ START DOING (–ù–∞—á–∞—Ç—å)

| # | –ù–æ–≤–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π |
|---|----------------|-----------|---------------|
| 1 | **E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (Playwright/Cypress)** | MEDIUM | Dana |
| 2 | **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ @Disabled —Ç–µ—Å—Ç–æ–≤ –≤ backlog** | HIGH | Bob |
| 3 | **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤ architecture.md** | LOW | Charlie |

---

## –ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ö–æ–¥–∫–∏ Epic 2

### 1. RestControllerAdvice –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å WebFilter (Story 2.3)

**–ü—Ä–æ–±–ª–µ–º–∞:** `@RestControllerAdvice` –Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏—è, –±—Ä–æ—à–µ–Ω–Ω—ã–µ –∏–∑ `WebFilter`.

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω `GlobalExceptionHandler` –∫–∞–∫ `ErrorWebExceptionHandler` —Å `@Order(Ordered.HIGHEST_PRECEDENCE)`.

**–§–∞–π–ª—ã:**
- `backend/gateway-admin/src/main/kotlin/com/company/gateway/admin/exception/GlobalExceptionHandler.kt`

### 2. JWT Token Validation —Å —Ä–∞–∑–ª–∏—á–µ–Ω–∏–µ–º —Ç–∏–ø–æ–≤ –æ—à–∏–±–æ–∫ (Story 2.3)

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω `validateTokenWithResult()` —Å sealed class `TokenValidationResult`:
- `Valid(claims)` ‚Äî —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω
- `Expired` ‚Äî —Ç–æ–∫–µ–Ω –∏—Å—Ç—ë–∫
- `Invalid` ‚Äî —Ç–æ–∫–µ–Ω –ø–æ–≤—Ä–µ–∂–¥—ë–Ω –∏–ª–∏ –ø–æ–¥–¥–µ–ª–∞–Ω

### 3. Role Hierarchy –≤ Spring Security (Story 2.4)

**–†–µ—à–µ–Ω–∏–µ:** `RoleHierarchy` Spring bean —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π `ADMIN > SECURITY > DEVELOPER`.

**–í–∞–∂–Ω–æ:** `@RequireRole(DEVELOPER)` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑—Ä–µ—à–∞–µ—Ç SECURITY –∏ ADMIN.

### 4. WebTestClient Cookie Issue (Story 2.6)

**–ü—Ä–æ–±–ª–µ–º–∞:** –í nested JUnit 5 –∫–ª–∞—Å—Å–∞—Ö WebTestClient –Ω–µ –ø–µ—Ä–µ–¥–∞—ë—Ç cookie –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

**–°–∏–º–ø—Ç–æ–º—ã:** –¢–æ–∫–µ–Ω –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è –∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è, –Ω–æ –∑–∞–ø—Ä–æ—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 401.

**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è. –¢–µ—Å—Ç `–¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è` –≤—Ä–µ–º–µ–Ω–Ω–æ @Disabled.

---

## Action Items

| # | Action Item | –í–ª–∞–¥–µ–ª–µ—Ü | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –°—Ä–æ–∫ | –°—Ç–∞—Ç—É—Å |
|---|-------------|----------|-----------|------|--------|
| 1 | –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å @Disabled —Ç–µ—Å—Ç –≤ Story 2.6 | Charlie | HIGH | Epic 3 Start | üî≤ Pending |
| 2 | –î–æ–±–∞–≤–∏—Ç—å E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è Admin UI | Dana | MEDIUM | Epic 4 | üî≤ Pending |
| 3 | –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å GlobalExceptionHandler pattern –≤ architecture.md | Charlie | LOW | Sprint Planning | üî≤ Pending |
| 4 | –°–æ–∑–¥–∞—Ç—å GitHub issue –¥–ª—è @Disabled —Ç–µ—Å—Ç–∞ | Bob | HIGH | Immediately | üî≤ Pending |
| 5 | –§–∏–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å checklist reactive patterns | Charlie | LOW | Epic 3 | üî≤ Pending |

---

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥ –≤—ã—è–≤–ª–µ–Ω–Ω—ã–π

| # | Debt Item | –ò—Å—Ç–æ—á–Ω–∏–∫ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | Target |
|---|-----------|----------|-----------|--------|
| 1 | @Disabled —Ç–µ—Å—Ç DELETE endpoint | Story 2.6 | HIGH | Epic 3 Start |
| 2 | Redis pub/sub publisher (–∏–∑ Epic 1) | Story 1.5 | LOW | Story 4.2 |
| 3 | E2E —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è UI | Story 2.5, 2.6 | MEDIUM | Epic 4 |

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ Epic 1 vs Epic 2

| –ú–µ—Ç—Ä–∏–∫–∞ | Epic 1 | Epic 2 | Trend |
|---------|--------|--------|-------|
| Code Reviews —Å –ø–æ–≤—Ç–æ—Ä–∞–º–∏ | 1 –∏–∑ 7 (14%) | 0 –∏–∑ 6 (0%) | ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ |
| HIGH issues –Ω–∞ review (avg) | 3.1 | 0.8 | ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ |
| @PostConstruct issues | 3 | 0 | ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ —Ü–µ–ª—å |
| –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º | 0% | 100% | ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ —Ü–µ–ª—å |
| @Disabled —Ç–µ—Å—Ç—ã | 0 | 1 | ‚ö†Ô∏è –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å |

---

## Preview Epic 3

**Epic 3: Rate Limiting & Throttling**

- **Scope:** Token bucket, rate limiting per route, metrics
- **FRs:** FR8, FR9, FR10
- **NFRs:** NFR3, NFR4
- **–ò—Å—Ç–æ—Ä–∏–∏:** 5 (3.1 - 3.5)

**–ö–ª—é—á–µ–≤—ã–µ —Ä–∏—Å–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ Epic 2:**
1. Redis integration ‚Äî —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å Testcontainers
2. High-concurrency scenarios ‚Äî –Ω—É–∂–Ω—ã load tests
3. Metrics integration ‚Äî –Ω–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å, –≤–æ–∑–º–æ–∂–Ω–æ Micrometer

---

## –ü–æ–¥–ø–∏—Å–∏

- **Scrum Master:** Bob ‚Äî —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∞, action items –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã
- **Product Owner:** Alice ‚Äî –≤—Å–µ –∏—Å—Ç–æ—Ä–∏–∏ delivered, scope –≤—ã–ø–æ–ª–Ω–µ–Ω –Ω–∞ 100%
- **Tech Lead:** Charlie ‚Äî —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞—Ö–æ–¥–∫–∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- **QA Lead:** Dana ‚Äî test coverage —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–π (224+ —Ç–µ—Å—Ç–æ–≤)

**–î–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–π —Ä–µ—Ç—Ä–æ—Å–ø–µ–∫—Ç–∏–≤—ã:** –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è Epic 3

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 2026-02-17*
*–í–µ—Ä—Å–∏—è: 1.0*
