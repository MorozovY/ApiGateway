# Retrospective Action Items Tracker
# =================================
# Этот файл отслеживает action items из ретроспектив между эпиками.
# SM агент проверяет этот файл при Sprint Planning (PA-04).
# Статусы: open, in-progress, done, cancelled
#
# Формат:
#   - id: уникальный идентификатор
#     description: описание action item
#     owner: владелец (имя или роль)
#     priority: critical, high, medium, low
#     status: open, in-progress, done, cancelled
#     source: из какой ретроспективы (epic-N-retro)
#     deadline: когда должно быть выполнено
#     created: дата создания
#     completed: дата завершения (если done)
#     notes: дополнительные заметки

generated: 2026-02-20
last_updated: 2026-02-26  # Epic 12 Retrospective completed

# =================================
# ACTIVE ACTION ITEMS
# =================================

action_items:
  # --- Epic 12 Action Items (2026-02-26) ---

  - id: E12-AI01
    description: "Интегрировать PA-09 (Migration Pre-flight Checklist) в story template для всех миграционных stories"
    owner: "SM (Bob)"
    priority: high
    status: open
    source: epic-12-retro
    deadline: Sprint 13
    created: 2026-02-26
    notes: "PA-09 создан после Story 12.2 инцидента, нужно формализовать в шаблоне"

  - id: E12-AI02
    description: "Создать документ 'Reactive Patterns Cookbook' — Mono.defer, switchIfEmpty, cache nullability, error handling"
    owner: "Tech Lead (Charlie)"
    priority: medium
    status: open
    source: epic-12-retro
    deadline: Sprint 14
    created: 2026-02-26
    notes: "Story 12.8 выявила проблемы с Caffeine null values и Mono.defer паттерном"

  - id: E12-AI03
    description: "E2E тесты добавлять раньше в epic — не откладывать на последнюю story"
    owner: "PO + Dev"
    priority: medium
    status: open
    source: epic-12-retro
    deadline: Ongoing
    created: 2026-02-26
    notes: "В Epic 12 E2E тесты были только в Story 12.10 (последняя)"

  - id: E12-AI04
    description: "Настроить lint rules для автоматической проверки комментариев на русском языке"
    owner: "Dev"
    priority: low
    status: open
    source: epic-12-retro
    deadline: Sprint 15
    created: 2026-02-26
    notes: "Много code review issues были про комментарии на английском вместо русского"

  - id: E12-AI05
    description: "Создать post-mortem template на основе Story 12.2 инцидента"
    owner: "SM (Bob)"
    priority: low
    status: open
    source: epic-12-retro
    deadline: Sprint 14
    created: 2026-02-26
    notes: "Стандартизировать формат документирования инцидентов"

  # --- Epic 11 Action Items (carried over) ---

  - id: E11-TD01
    description: "Fix pre-existing TypeScript errors in RouteDetailsCard.test.tsx — literal types вместо UserRole"
    owner: "Charlie"
    priority: low
    status: open
    source: epic-11-retro
    deadline: Epic 13
    created: 2026-02-23
    notes: "Ошибки существовали до Story 11.6, стали заметнее после рефакторинга"

  - id: E11-DOC01
    description: "Update docs/webflux-patterns.md — clarify @Configuration exception for @PostConstruct"
    owner: "Paige"
    priority: low
    status: open
    source: epic-11-retro
    deadline: Epic 13
    created: 2026-02-23
    notes: "MdcContextConfig.kt использует @PostConstruct, но это допустимо для @Configuration классов"

# =================================
# PROCESS AGREEMENTS
# =================================

process_agreements:
  - id: PA-01
    description: "LOW issues исправляем сразу — code review не approved пока все severity levels не resolved"
    source: epic-6-retro
    created: 2026-02-20
    status: active

  - id: PA-02
    description: "API Dependencies checklist — при создании UI story проверять что backend поддерживает все AC"
    source: epic-6-retro
    created: 2026-02-20
    status: active

  - id: PA-03
    description: "Hotfix reproduction required — баг должен быть воспроизведён перед созданием hotfix story"
    source: epic-7-retro
    created: 2026-02-21
    status: active

  - id: PA-04
    description: "Action Items review — SM проверяет retro-actions.yaml на каждом Sprint Planning"
    source: epic-7-retro
    created: 2026-02-21
    status: active

  - id: PA-05
    description: "DTO Field Checklist — при добавлении поля в DTO проверить все методы создания/обновления"
    source: epic-8-retro
    created: 2026-02-21
    status: active

  - id: PA-06
    description: "useEffect Cleanup — для setInterval/setTimeout/subscriptions обязателен cleanup в return"
    source: epic-8-retro
    created: 2026-02-21
    status: active

  - id: PA-07
    description: "Docker Data Protection — запрещено docker-compose down -v без явного подтверждения пользователя"
    source: epic-12-retro (Story 12.2 incident)
    created: 2026-02-23
    status: active

  - id: PA-08
    description: "Non-Breaking Changes (рекомендация) — предложить подход и дождаться подтверждения пользователя"
    source: epic-12-retro (Story 12.2 incident)
    created: 2026-02-23
    updated: 2026-02-26
    status: active

  - id: PA-09
    description: "Migration Pre-flight Checklist — перед миграцией auth/API/DB проверить работоспособность, feature flag, rollback plan"
    source: epic-12-retro (Story 12.2 incident)
    created: 2026-02-23
    status: active

  - id: PA-10
    description: "Dangerous Operations Confirmation — спрашивать явное подтверждение перед удалением production кода, изменением auth"
    source: epic-12-retro (Story 12.2 incident)
    created: 2026-02-23
    status: active

# =================================
# COMPLETED ACTION ITEMS
# =================================

completed_items:
  # --- Epic 11 (2026-02-23) ---

  - id: E10-01
    description: "Рефакторинг проверки ролей — централизованные хелперы canRollback(), canDelete(), canModify() с TypeScript literal types"
    owner: "Charlie"
    priority: medium
    status: done
    source: epic-10-retro
    deadline: Epic 11
    created: 2026-02-23
    completed: 2026-02-23
    notes: "Story 11.6. Реализованы 7 helpers: isAdmin, isDeveloper, isAdminOrSecurity, canApprove, canRollback, canDelete, canModify. 42 unit теста."

  # --- Tech Sprint 2026-02-21 ---

  - id: E7-01
    description: "Формализовать API Dependencies checklist в story template — обязательная секция для UI stories"
    owner: "SM (Bob)"
    priority: high
    status: done
    source: epic-7-retro
    created: 2026-02-21
    completed: 2026-02-21
    notes: "Добавлено в _bmad/bmm/workflows/4-implementation/create-story/template.md и checklist.md"

  - id: E7-02
    description: "Review Action Items в Sprint Planning — SM проверяет retro-actions.yaml в начале каждого спринта"
    owner: "SM (Bob)"
    priority: high
    status: done
    source: epic-7-retro
    created: 2026-02-21
    completed: 2026-02-21
    notes: "Документировано в CLAUDE.md как PA-04"

  - id: E7-03
    description: "Hotfix stories требуют reproduction steps — не создавать без подтверждённого воспроизведения"
    owner: "QA (Dana)"
    priority: high
    status: done
    source: epic-7-retro
    created: 2026-02-21
    completed: 2026-02-21
    notes: "Документировано в CLAUDE.md как PA-03"

  - id: E6-02
    description: "Документировать что создаёт gateway метрики (только published routes, не actuator endpoints)"
    owner: "Dev (Charlie)"
    priority: medium
    status: done
    source: epic-6-retro
    created: 2026-02-20
    completed: 2026-02-21
    notes: "Добавлено в architecture.md: Gateway Metrics Collection секция"

  - id: E6-03
    description: "Filter ordering documentation в architecture.md"
    owner: "Dev (Charlie)"
    priority: medium
    status: done
    source: epic-5-retro
    created: 2026-02-19
    completed: 2026-02-21
    notes: "Добавлено в architecture.md: Gateway Filter Ordering секция"

  - id: E6-05
    description: "Документировать Redis pub/sub channels в architecture.md"
    owner: "Dev (Charlie)"
    priority: low
    status: done
    source: epic-5-retro
    created: 2026-02-19
    completed: 2026-02-21
    notes: "Добавлено в architecture.md: Redis Pub/Sub Channels секция"

  - id: E6-06
    description: "Аудит skipped тестов — собрать все .skip(), @Disabled, @Ignore по проекту"
    owner: "Elena"
    priority: high
    status: done
    source: epic-6-retro
    created: 2026-02-20
    completed: 2026-02-21
    notes: "Отчёт: skipped-tests-audit-2026-02-21.md. 3 теста найдено (1 намеренный, 2 LOW priority)"

  - id: E6-07
    description: "Создать Story/план для устранения skipped тестов"
    owner: "SM (Bob)"
    priority: high
    status: done
    source: epic-6-retro
    created: 2026-02-20
    completed: 2026-02-21
    notes: "Включено в аудит-отчёт. Рекомендация: не создавать отдельную story, добавить в backlog"

  - id: E6-04
    description: "correlationId logging через MDC"
    owner: "Dev"
    priority: low
    status: done
    source: epic-5-retro
    created: 2026-02-19
    completed: 2026-02-21
    notes: "Уже реализовано в gateway-core (MdcContextConfig + logback-spring.xml). Gateway-admin использует Reactor Context."

  - id: E6-08
    description: "Story 7.0: MetricsService → Prometheus HTTP API — UI метрики должны показывать реальные данные"
    owner: "Charlie"
    priority: critical
    status: done
    source: epic-6-retro
    created: 2026-02-20
    completed: 2026-02-21
    notes: "CRITICAL blocker resolved. PrometheusClient реализован с retry и fallback."

  # --- Epic 6 Retro ---

  - id: E6-00
    description: "Создать retro-actions.yaml для трекинга action items"
    owner: "SM (Bob)"
    priority: high
    status: done
    source: epic-6-retro
    created: 2026-02-20
    completed: 2026-02-20
    notes: "Этот файл"

  - id: E6-01
    description: "Добавить API Dependencies checklist в UI story template"
    owner: "SM (Bob)"
    priority: high
    status: cancelled
    source: epic-6-retro
    created: 2026-02-20
    completed: 2026-02-21
    notes: "Заменён на E7-01 с более конкретным описанием"
